@model PasteBookFinalProject.Models.VMPostUser

@section Login{

    @using (Html.BeginForm("Index", "Pastebook", FormMethod.Post))
    {
        <ul class="nav navbar-nav">

            <li class="nav-item login">
               Welcome @Model.UserModelDetails.USER_NAME !
            </li>
            <li class="nav-item login">
                <input class="form-control" type="text" placeholder="Search">
            </li>
            <li class="nav-item login">
                <button class="btn  btn-primary" type="submit">Search</button>
            </li>
            <li class="nav-item">
                @Html.ActionLink("Timeline", "Timeline", "PasteBook")
            </li>
            <li class="nav-item">
                @Html.ActionLink("Profile Account", "ProfileView", "PasteBook")
            </li>
            <li class="nav-item">
                @Html.ActionLink("Friends", "FriendsView", "PasteBook")
            </li>
            <li class="nav-item">
                @Html.ActionLink("Notifications", "NotificationsView", "PasteBook")
            </li>
            <li class="login">
                <button type="submit" class="btn btn-primary" id="logoutButton">Logout</button>
            </li>
        </ul>
    }
}

<div class="container" id="accountProfile">


    <div class="col-md-4 col-md-offset-1">
        <div class="well well-lg">
            <img src="~/Content/images/user.png" id="userPicture" />
        </div>

        <div class="well well-lg">
            <h1>
                @Model.UserModelDetails.FIRST_NAME 
                @Model.UserModelDetails.LAST_NAME
            </h1>
        </div>
    </div>
    <div class="col-md-6">
        <div class="panel panel-default">
            <div class="panel-heading text-left">
               @Model.UserModelDetails.FIRST_NAME @Model.UserModelDetails.LAST_NAME
            </div>

            <div class="panel-body">
                @Html.TextArea("postContent", null, new { @cols = "80", @rows = "4", placeholder = "What's on your mind?", id = "postContent" })
                
            </div>

            <div class="panel-footer text-left">
                <button type="submit" class="btn btn-primary" id="addPost">POST</button>
            </div>
        </div>
    </div>

    <div class="col-md-6" id="postRefresh">
        @{
            Html.RenderAction("PostList","PasteBook");
        }
    </div>
    </div>

   

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <script>
        var addPost = '@Url.Action("AddPost", "PasteBook")'
        var reloadPostList = '@Url.Action("PostList", "PasteBook")'

        $(document).ready(function () {
            $("#addPost").click(function () {
                var data = {
                    postContent: $('#postContent').val()
                }
                $.ajax({
                    url: addPost,
                    data: data,
                    type: 'POST',
                    success: function (data) {
                        reload();
                    },
                    error: function () {
                        alert('Something went wrong.')
                    }
                })
            });

            //refresh contents of the postList partialView
            function reload() {
                $("#postRefresh").load(reloadPostList);
                $("#postContent").val("");
            };

        });
    </script>
}